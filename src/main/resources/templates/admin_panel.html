<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin Drone Assignment</title>
    <meta http-equiv="refresh" content="10" />
</head>
<body>

<h2>üöÅ Pending Orders</h2>
<table border="1">
    <tr><th>Order ID</th><th>Item</th><th>Location</th><th>Assign Drone</th></tr>
    <tr th:each="entry : ${orders}" th:if="${entry.value.status == 'waiting_for_drone'}">
        <td th:text="${entry.key}">Order ID</td>
        <td th:text="${entry.value.foodItem}">Food</td>
        <td th:text="'(' + ${entry.value.lat} + ', ' + ${entry.value.lng} + ')'">LatLng</td>
        <td>
            <form method="post" action="/assign">
                <input type="hidden" name="orderId" th:value="${entry.key}" />
                <select name="droneId" required>
                    <option th:each="drone : ${drones}" th:value="${drone}" th:text="${drone}"></option>
                </select>
                <button type="submit">Assign</button>
            </form>
        </td>
    </tr>
</table>

<h2>Orders In Progress</h2>
<table border="1">
    <tr><th>Order ID</th><th>Drone ID</th><th>Action</th></tr>
    <tr th:each="order : ${orders}" th:if="${#strings.startsWith(order.value.status, 'drone_')}">
        <td th:text="${order.key}"></td>
        <td th:text="${order.value.status}"></td>
        <td>
            <form method="post" th:action="@{/complete}">
                <input type="hidden" name="orderId" th:value="${order.key}" />
                <input type="hidden" name="droneId" th:value="${order.value.status}" />
                <button type="submit">‚úÖ Mark Complete</button>
            </form>
        </td>
    </tr>
</table>

<h2>Orders Completed</h2>
<table border="1">
    <tr><th>Order ID</th><th>Status</th></tr>
    <tr th:each="order : ${orders}" th:if="${order.value.status == 'Order Completed'}">
        <td th:text="${order.key}"></td>
        <td th:text="${order.value.status}"></td>
    </tr>
</table>

</body>
</html>
